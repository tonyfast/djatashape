---
---
<!doctype html>
<head>
    <script src="{{site.baseurl}}/bower_components/pegjs/peg-0.9.0.min.js"></script><script src="{{site.baseurl}}/bower_components/codemirror/lib/codemirror.js"></script><script src="{{site.baseurl}}/bower_components/d3/d3.min.js"></script><script src="{{site.baseurl}}/bower_components/codemirror/addon/fold/foldcode.js"></script><script src="{{site.baseurl}}/bower_components/codemirror/addon/fold/foldgutter.js"></script>
    <link rel="stylesheet" type="text/css" href="{{site.baseurl}}/bower_components/bootstrap/dist/css/bootstrap.min.css"/><link rel="stylesheet" type="text/css" href="{{site.baseurl}}/bower_components/bootstrap/dist/css/bootstrap-theme.min.css"/><link rel="stylesheet" type="text/css" href="{{site.baseurl}}/bower_components/codemirror/lib/codemirror.css"/>
</head>
<body>
    <script>// Generated by CoffeeScript 1.10.0
window.parser = (PEG.buildParser("/** A PegJS grammar for Python DataShape **/\n\n{\n  function toObject( array ){\n    /** Convert an array of {key,value} objects to an objecy **/\n    var tmp = {};\n    array.forEach( function(entry){\n        tmp[entry.key] = entry.value;\n    });\n    if ( tmp === {} ){ return null; }\n    return tmp;\n  };\n}\n\n/** First Parsing Expression **/\ndatashape = output:(shapes / structure / type ) _ { return output; }\n\n/** Array Shapes trail with a type **/\nshapes = _ shape:(shape)+ _ type:datashape {\n  return {\n    shape: shape,\n    type: type\n  };\n}\n\n/** The shape is an integer or ``var`` separated by an asterisk **/\nshape = shape:( integer / \"var\" ) _ '*' _  { return shape; }\n\n/** Object DataShape defintion **/\nstructure =  '{' _ entries:structure_entries? entry:(structure_entry) '}' {\n  entries = entries ? entries : [];\n  entries.push(entry = entry ? entry : void(0));\n  return toObject( entries );\n}\n\n/** key/value pairs separated with a colon **/\nstructure_entry = key:string _ ':' _ value:datashape { return { key: key, value: value,}; }\nstructure_entries = entries:( entry:structure_entry _ ',' _ { return entry; })+ { return entries; }\n\n/** DataShape types **/\ntype = inferred:'?'?  type:types params:compound? {\n  if ( params || inferred ){\n      params = params ? params : {}\n      inferred ? ( params['inferred'] = true ) : void(0);\n      return {type: type, params: params }\n  } else {\n      return {type: type}\n  }\n}\n\ntypes = (t:'int' b:(\"8\"/\"16\"/\"32\"/\"64\"/\"128\")? { return t+(b==null?'32':b) }) /\n    (t:'unit' b:(\"8\"/\"16\"/\"32\"/\"64\"/\"128\")? { return t+(b==null?'32':b) }) /\n    (t:'float' b:(\"8\"/\"16\"/\"32\"/\"64\"/\"128\")? { return t+(b==null?'32':b) }) /\n    (t:'decimal' b:(\"32\"/\"64\"/\"128\")? { return t+(b==null?'32':b) }) /\n    t:('char' / 'json' / 'void' / 'pointer' / 'complex' / 'string' / 'bytes' / 'datetime' / 'categorical') { return t;  }\n\ncompound = '[' arg:(simple_type / args:(compound_type)+ { return args; } ) _ ']' { return arg; }\n\nsimple_type = value:types { return { key: 'type', value: value } }\n\ncompound_type  =  _ entries:compound_entries? entry:(compound_entry) {\n  entries = entries ? entries : [];\n  entries.push(entry = entry ? entry : void(0));\n  return toObject( entries );\n}\n\ncompound_entries = entries:(entry:compound_entry  _ ',' _ { return entry; } )+ { return entries };\ncompound_entry = key:string _ '=' _ value:(literal_string/types/list) { return { key: key, value: value,};  } /\n  value:types { return {key: 'type', value: value}; }\n\nlist = '['_ entries:(_ v:literal_string _ ',' { return v;})* _ entry:literal_string _ ']' {\n  entries = entries ? entries : [];\n  entries.push(entry = entry ? entry : void(0));\n  return entries;\n}\n\n\nliteral_string = ( '\"' s:string '\"' {return s;} / \"'\" s:string \"'\" {return s;})\nstring = chars:([a-zA-Z0-9_ ])+ { return chars.join('') }\ninteger = value:[0-9]+ { return parseFloat(value.join(\"\"), 10); }\n\n_  = [\\ \\t\\r\\n]*")).parse;
</script>
    <div class="container">
        <h1>DataShape in the Browser</h1>
        <p>Type a DataShape Grammar into the editor and it's Javascript serialization is returned below.</p>
        <hr>
        <div class="row"  id="editor"></div>
        <hr>
        <div class="row" id="preview"></div>
    </div>
</body>
<script>// Generated by CoffeeScript 1.10.0
(function() {
  var preview;

  window.cm = CodeMirror(d3.select('#editor').node(), {
    theme: "blackboard",
    lineNumbers: true,
    lineWrapping: true,
    readOnly: false,
    gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
  });

  preview = d3.select('#preview').selectAll('pre > code').data([0]).enter().append('pre').append('code');

  cm.on('change', (function(_this) {
    return function() {
      return preview.text(JSON.stringify(parser(cm.getValue()), null, 2));
    };
  })(this));

  cm.setValue("10 * 2 * {\n  day: datetime,\n  first_name: ?string,\n  last_name: string,\n  info: {\n      filename: string,\n      market: 2 * categorical[values=['fish','trampoline','hot air balloons']]\n  }\n}");

}).call(this);
</script>